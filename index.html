<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Agenda RE/MAX Soul</title>
<link href="https://fonts.googleapis.com/css2?family=Questrial&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="topo">
  <img src="balloon.png" class="logo">
  <div class="marca">
    <span class="re">RE</span><span class="barra">/</span><span class="max">MAX</span>
    <span class="soul">Soul</span>
  </div>
</div>

<div class="box">
  <label>Data</label>
  <input type="date" id="data">

  <label>Horário</label>
  <div id="slots"></div>

  <label>Nome</label>
  <input type="text" id="nome">

  <label>Motivo</label>
  <input type="text" id="motivo">

  <!-- Botão corrigido com texto visível -->
  <button onclick="agendar()">Agendar</button>
  <div id="msg"></div>
</div>

<div class="agendaBox">
  <h3>Agendamentos confirmados</h3>
  <ul id="agenda"></ul>
</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbxGFLGvVQHkxBWZarJTgJlg5yomvfBh85H-UwlEH7hVnfSrP54byq_wFgdix-563U1U/exec";

const HORARIOS=["07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30"];
let selecionado=null;

document.getElementById("data").addEventListener("change",carregarSlots);

function formatarDataBR(iso){const [a,m,d]=iso.split("-");return `${d}/${m}/${a.slice(2)}`;}

async function carregarSlots(){
  const dataISO=document.getElementById("data").value;
  if(!dataISO)return;
  const dataBR=formatarDataBR(dataISO);

  const res=await fetch(API_URL+"?t="+Date.now());
  const agenda=await res.json();
  const ocupados=agenda.filter(a=>a.data===dataBR).map(a=>a.hora);

  const div=document.getElementById("slots");
  div.innerHTML="";
  selecion
